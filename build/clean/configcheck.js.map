{"version":3,"names":[],"mappings":"","sources":["configcheck.js"],"sourcesContent":["\"use strict\";\nconst R = require('ramda');\nconst inspector = require('schema-inspector');\nconst config_example_1 = require('./config-example');\nconst task_1 = require('./task/task');\nconst project_1 = require('./task/project');\nconst Prop = require('./package/props-type');\nconst validmodel_1 = require('./task/validmodel');\nconst gulp = require('gulp');\nconst logger_1 = require('./logger');\nconst log = logger_1.Logger.initPrint('config check');\nconst source = config_example_1.sample.source;\nconst result = config_example_1.sample.result;\nconst propsCheck = Prop.propsType;\nclass ResultConfigCheck {\n}\nResultConfigCheck.stringCheck = propsCheck([String]);\nResultConfigCheck.arrObjCheck = propsCheck([Array, Object]);\nResultConfigCheck.resultTabs = (obj) => ResultConfigCheck.arrObjCheck(['dir', 'taskOpts', 'name', 'pipe'])(obj);\nResultConfigCheck.ResultCheck = {\n    name: ResultConfigCheck.stringCheck([''])\n};\nResultConfigCheck.validate = (obj) => inspector.validate(validmodel_1.ValidatorModel.ResultConfig, obj).valid;\nclass SourceConfig {\n    static splitProjects(obj) {\n        let projectMap = new Map();\n        R.forEach(e => projectMap.set(e[0], SourceConfig.childMap(e[1])), R.toPairs(obj));\n        return projectMap;\n    }\n    static childMap(obj) {\n        let childMap = new Map();\n        R.forEach(e => childMap.set(e[0], e[1]), R.toPairs(obj));\n        return childMap;\n    }\n    static onEveryTask(project, func) {\n        let result = new Map();\n        const createSubproject = (subname, taskname, task) => R.when(() => R.not(result.has(subname)), result.set(subname, new Map()));\n        const createTask = (subname, taskname, task) => {\n            createSubproject(subname, taskname, task);\n            console.assert(result.has(subname), `${subname} subtask not created! Task: ${taskname}`);\n            return (_func) => result.get(subname).set(taskname, _func(subname, taskname, task));\n        };\n        project.forEach((sub, subname) => sub.forEach((task, taskname) => createTask(subname, taskname, task)(func)));\n        return result;\n    }\n}\nSourceConfig.ConstructTask = (subname, taskname, obj) => R.constructN(3, task_1.FullTask)(subname, taskname, obj);\nlet projectSplit = SourceConfig.splitProjects(source);\nlet withNames = SourceConfig.onEveryTask(projectSplit, SourceConfig.ConstructTask);\nlet styl = withNames.get('client').get('stylus');\nlog.tags(['styl object', 'pipes']).debug(styl.pipes);\nlet conf = project_1.Projectlist.configSplitter(source);\nconsole.info(conf);\nconf.render();\nlog.log(gulp.hasTask('client:stylus'));\nlog.log(gulp.hasTask('client'));\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.default = {};\n"],"file":"configcheck.js","sourceRoot":"/source/"}