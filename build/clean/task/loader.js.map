{"version":3,"names":[],"mappings":"","sources":["task/loader.js"],"sourcesContent":["\"use strict\";\nconst R = require('ramda');\nconst resolve = require('resolve');\nconst util = require('gulp-util');\nconst logger_1 = require('../logger');\nconst log = logger_1.Logger.initPrint('loader');\nclass Loader {\n    static require(_loader) {\n        return Loader.tryCatchRequire(_loader, R.when(R.is(String), Loader.resolveString));\n    }\n    static tryCatchRequire(_loader, func) {\n        let req = null;\n        try {\n            req = func(_loader);\n        }\n        catch (e) {\n            log.error(`Loader.tryCatchRequire error! loader ${_loader} ${e.name} ${e.message}`);\n            req = util.noop;\n        }\n        return req;\n    }\n    static resolveString(_loader) {\n        const prependWord = add => str => R.pipe(R.of, R.prepend(add), R.join('-'))(str);\n        const isWithPrefix = R.ifElse(R.pipe(R.head, R.equals('^')), R.tail, prependWord('gulp'));\n        let resolved = Loader.syncLoad(isWithPrefix(_loader));\n        return R.ifElse(R.isNil, () => util.noop, require)(resolved);\n    }\n    static asyncLoad(moduleName) {\n        const asyncCallback = function (err, res) {\n            if (err)\n                console.error(err);\n            else\n                log.tags(['async load info']).info(res);\n            return res;\n        };\n        return resolve(moduleName, { basedir: __dirname }, asyncCallback);\n    }\n    static syncLoad(moduleName) {\n        let _module = null;\n        try {\n            _module = resolve.sync(moduleName, { basedir: __dirname });\n        }\n        catch (e) {\n            log.error(`Sync load module error! ${e.name} ${e.message}`);\n        }\n        finally {\n            return _module;\n        }\n    }\n}\nexports.Loader = Loader;\n"],"file":"task/loader.js","sourceRoot":"/source/"}