"use strict";function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};!function(e){if("object"===("undefined"==typeof exports?"undefined":_typeof(exports))&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.gulpGate=e()}}(function(){return function e(t,r,n){function i(a,u){if(!r[a]){if(!t[a]){var s="function"==typeof require&&require;if(!u&&s)return s(a,!0);if(o)return o(a,!0);var l=new Error("Cannot find module '"+a+"'");throw l.code="MODULE_NOT_FOUND",l}var c=r[a]={exports:{}};t[a][0].call(c.exports,function(e){var r=t[a][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<n.length;a++)i(n[a]);return i}({1:[function(e,t,r){var n=e("bucker"),i={console:{colors:!0}},o=function(){function e(t){_classCallCheck(this,e),this.modulename=t,this.logger=n.createLogger(e.options,t,function(e){e&&console.error("failed loading bucker plugin")})}return _createClass(e,[{key:"log",get:function(){return this.logger.log}},{key:"warn",get:function(){return this.logger.warn}},{key:"tags",get:function(){return this.logger.tags}}],[{key:"initPrint",value:function(t){var r=new e(t);return r.logger.tags(["module init"]).log("--module "+t+"--"),r.logger}}]),e}();o.options=i,r.Logger=o},{bucker:void 0}],2:[function(e,t,r){(function(t){var n=e("ramda"),i=e("resolve"),o=e("gulp-util"),a=e("../logger"),u=a.Logger.initPrint("loader"),s=function(){function r(){_classCallCheck(this,r)}return _createClass(r,null,[{key:"require",value:function(e){return r.tryCatchRequire(e,n.when(n.is(String),r.resolveString))}},{key:"tryCatchRequire",value:function(e,t){var r=null;try{r=t(e)}catch(t){u.error("Loader.tryCatchRequire error! loader "+e+" "+t.name+" "+t.message),r=o.noop}return r}},{key:"resolveString",value:function(t){var i=function(e){return function(t){return n.pipe(n.of,n.prepend(e),n.join("-"))(t)}},a=n.ifElse(n.pipe(n.head,n.equals("^")),n.tail,i("gulp")),u=r.syncLoad(a(t));return n.ifElse(n.isNil,function(){return o.noop},e)(u)}},{key:"syncLoad",value:function(e){var r=null;try{r=i.sync(e,{basedir:t})}catch(e){u.error("Sync load module error! "+e.name+" "+e.message)}finally{return r}}}]),r}();r.Loader=s}).call(this,"/_projects\\Web\\gulp-gate\\build\\clean\\task")},{"../logger":1,"gulp-util":void 0,ramda:void 0,resolve:void 0}],3:[function(e,t,r){var n=e("ramda"),i=e("gulp"),o=e("gulp-util"),a=e("../util"),u=e("../util"),s=e("./validmodel"),l=e("./loader"),c=e("../logger"),p=c.Logger.initPrint("pipe"),f=e("schema-inspector"),d=function(e){return p.tags(["fabric type"]).log("==Fabric "+e+"==")},y=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"BatchFabric",value:function(t){var r=t.defpath(["pipe"])(t.obj),i=n.when(n.is(Array),e.FabricArray);return p.tags(["pipeFactory","batch","pipes[0]"]).log(r[0]),p.tags(["pipeFactory","batch","is array?"]).log(i(r)),i(r)}},{key:"Pipe",value:function(e,t){return d("Pipe"),{loader:e,opts:u.makeArrayIfIsnt(t)}}},{key:"FabricArray",value:function(t){return d("Array"),n.map(e.FabricObject,t)}},{key:"FabricObject",value:function(t){d("Object");var r=function(e){var t=n.keys(e);p.tags(["pipe","keys","values"]).log("---------keys length "+t.length+" "+t+" "+n.values(e))},i=function(e){return f.validate(s.ValidatorModel.Pipe,e).valid},o=function(t){return n.when(function(e){return n.is(String,e.loader)},n.pipe(a.reflectLogger(function(e){return p.debug("loader",l.Loader.require(e.loader))}),function(t){return e.Pipe(l.Loader.require(t.loader),t.opts)}))(t)},u=n.pipe(n.keys,n.length,n.equals(1));return r(t),n.cond([[u,e.FabricKeypair],[i,o],[n.is(String),e.FabricString],[n.T,e.FabricNoop]])(t)}},{key:"FabricKeypair",value:function(t){d("Keypair");var r=n.toPairs(t)[0],i=l.Loader.require(r[0]);return e.Pipe(i,r[1])}},{key:"FabricNoop",value:function(){return d("Noop"),e.Pipe(o.noop,[])}},{key:"FabricString",value:function(t){d("String");var r=l.Loader.require(t);return p.debug(r),e.Pipe(r,[])}}]),e}();y.RenderPipeline_deprecated=function(e){return n.reduce(function(e,t){return t(e)},i.src("./source/*.styl"),n.map(y.RenderPipe,e))},y.RenderPipe=function(e){return function(t){return n.when(n.is(Function),function(r){return t.pipe(n.apply(r,e.opts))})(e.loader)}},y.RenderFirstPipe=function(e){return n.when(n.is(Function),function(t){return n.apply(t,e.opts)})(e.loader)},r.Pipe=y;var h=function e(){_classCallCheck(this,e)};h.append=function(e){return function(t){return n.append(e,t)}},h.prepend=function(e){return function(t){return n.prepend(e,t)}},h.enclose=function(e,t){return function(r){return n.pipe(h.prepend(e),h.append(t))(r)}},h.render=function(e){var t=n.head(e),r=n.tail(e);return n.reduce(function(e,t){return t(e)},y.RenderFirstPipe(t),n.map(y.RenderPipe,r))},r.Pipeliner=h},{"../logger":1,"../util":7,"./loader":2,"./validmodel":6,gulp:void 0,"gulp-util":void 0,ramda:void 0,"schema-inspector":void 0}],4:[function(e,t,r){var n=e("ramda"),i=e("gulp"),o=e("./task"),a=function(e){return n.pluck("uid")(e.list)},u=function e(){_classCallCheck(this,e)};u.toPairs=n.toPairs,u.tasklist=function(e){return n.pipe(u.toPairs,n.map(e))},u.pairToProject=function(e){return n.apply(c.configSplitter,e)},u.pairToTask=function(e){return function(t){return new o.FullTask(e,t[0],t[1])}},u.splitProjectlist=function(e){return new l(u.tasklist(u.pairToProject)(e))},u.splitProject=function(e,t){return new c(u.tasklist(u.pairToTask(t))(e),t)};var s=function(){function e(t,r){_classCallCheck(this,e),this.list=t,this.uid=r,this.rendered=!1}return _createClass(e,[{key:"render",value:function(){var e=this,t=function(){e.list.forEach(function(e){return e.render()}),e.rendered=!0,i.task(e.uid,a(e))};e.rendered||t()}},{key:"run",value:function(){return this.render(),i.start([this.uid])}}]),e}(),l=function(e){function t(e){_classCallCheck(this,t);var r=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,"build-all"));return r.list=e,r}return _inherits(t,e),_createClass(t,[{key:"get",value:function(e){return n.find(function(t){return t.uid===e})(this.list)}}]),t}(s);l.configSplitter=function(e){return u.splitProjectlist(e)},r.Projectlist=l;var c=function(e){function t(e,r){_classCallCheck(this,t);var n=_possibleConstructorReturn(this,Object.getPrototypeOf(t).call(this,e,r));return n.list=e,n.uid=r,n}return _inherits(t,e),_createClass(t,[{key:"get",value:function(e){return n.find(function(t){return t.name.short===e})(this.list).UserAdapter}}]),t}(s);c.configSplitter=function(e,t){return u.splitProject(t,e)},r.Project=c},{"./task":5,gulp:void 0,ramda:void 0}],5:[function(e,t,r){var n=e("gulp"),i=e("ramda"),o=e("path"),a=e("./pipe"),u=e("./pipe"),s=e("./validmodel"),l=e("../logger"),c=l.Logger.initPrint("task"),p=e("schema-inspector"),f=e("gulp-plumber"),d=e("gulp-sourcemaps"),y=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"Morph",value:function(t){var r=t.task;r.name=e.NameFabric(t),r.filemask=e.FilemaskFabric(t),r.dir=e.DirFabric(t),r.taskOpts=e.TaskOptsFabric(t),r.list=e.PipesFabric(t)}},{key:"NameFabric",value:function(e){var t=function(e,t){return[e,t].join(":")};return{short:e.taskname,full:t(e.subname,e.taskname)}}},{key:"pathMaker",value:function(e){return i.pipe(i.prepend(process.cwd()),i.apply(o.join))(e)}},{key:"FilemaskFabric",value:function(e){var t=e.defpath(["include","ext"]),r=function(e,t){return[t?t:"*",e].join(".")},n=i.pathOr(!1,["include","deep"]),o=i.pipe(t,r,i.of);return i.ifElse(n,i.pipe(o,i.prepend("**")),o)(e.obj)}},{key:"DirFabric",value:function(t){var r=function(e){return t.defpath(["dir",e])(t.obj)},n=function(e,n){return[n?n:e,t.subname,r(e)]};return{source:e.pathMaker(i.concat(n("source"),t.task.filemask)),dest:e.pathMaker(n("dest","build"))}}},{key:"TaskOptsFabric",value:function(e){return p.sanitize(s.ValidatorModel.TaskOpts,i.propOr({},"taskOpts",e.obj)).data}}]),e}();y.PipesFabric=function(e){return a.Pipe.BatchFabric(e)};var h=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"Morph",value:function(t){t.list=e.addMaps(t),t.list=e.addProtect(t),t.list=e.addSrcDest(t)}},{key:"addSrcDest",value:function(t){var r=function(e){return i.or(i.not(i.isNil(e.dir.dest)),i.equals(!1,e.dir.dest))},o=function(e){return a.Pipe.Pipe(n.src,[e.dir.source])},s=function(e){return a.Pipe.Pipe(n.dest,[e.dir.dest])},l=function(t){var n=r(t),a=o(t),l=function(){return s(t)},c=n?u.Pipeliner.enclose(a,l()):u.Pipeliner.append(a);return i.pipe(e.list,c)(t)};return l(t)}},{key:"addProtect",value:function(t){return i.ifElse(i.path(["TaskOpts","protect"]),i.pipe(e.list,u.Pipeliner.prepend(a.Pipe.Pipe(f,[]))),e.list)(t)}},{key:"addMaps",value:function(t){return i.ifElse(i.path(["taskOpts","sourceMaps"]),i.pipe(e.list,u.Pipeliner.enclose(a.Pipe.Pipe(d.init,[]),a.Pipe.Pipe(d.write,["."]))),e.list)(t)}},{key:"list",get:function(){return i.prop("list")}}]),e}(),g=function(){function e(t,r,n){_classCallCheck(this,e),this.subname=t,this.taskname=r,this.obj=n,this.rendered=!1,y.Morph(this.PreprocessAdapter),h.Morph(this)}return _createClass(e,[{key:"render",value:function(){var e=this,t=function(){var t=u.Pipeliner.render(e.list);return n.task(e.name.full,function(){return t}),e.rendered=!0,t};this.list.forEach(function(e){return c.info("----------------loader "+e.loader+" opts "+e.opts)}),this.rendered||t()}},{key:"run",value:function(){return this.render(),n.start([this.name.full])}},{key:"PreprocessAdapter",get:function(){return{taskname:this.taskname,subname:this.subname,obj:this.obj,defpath:i.pathOr(this.taskname),task:this}}},{key:"UserAdapter",get:function(){return{task:this.name.short,uid:this.name.full,project:this.subname,render:this.render,run:this.run}}},{key:"uid",get:function(){return this.name.full}}]),e}();r.FullTask=g},{"../logger":1,"./pipe":3,"./validmodel":6,gulp:void 0,"gulp-plumber":void 0,"gulp-sourcemaps":void 0,path:void 0,ramda:void 0,"schema-inspector":void 0}],6:[function(e,t,r){var n=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"BoolDef",value:function(e){return{type:"boolean",optional:!1,def:e}}},{key:"NoEmptyString",get:function(){return{type:"string",minLength:1,optional:!1}}},{key:"TaskOpts",get:function(){var t=e.BoolDef;return{type:"object",properties:{protect:t(!0),sourceMaps:t(!0),notify:t(!1),cache:t(!0),cleanBefore:t(!1)}}}},{key:"Pipe",get:function(){return{type:"object",optional:!1,properties:{loader:{type:["function","string"],optional:!1},opts:{type:"any",optional:!0}}}}},{key:"PipeArray",get:function(){return{type:"array",items:e.Pipe,optional:!1}}},{key:"ResultConfig",get:function(){return{type:"object",properties:{name:{type:"object",optional:!1,properties:{short:e.NoEmptyString,full:e.NoEmptyString}},dir:{type:"object",optional:!1,properties:{source:e.NoEmptyString,dest:e.NoEmptyString}},taskOpts:e.TaskOpts,pipe:{type:"array",items:{type:"object",optional:!1,properties:{loader:{type:["function","string"],optional:!1},opts:{type:"any",optional:!0}}},optional:!1}}}}}]),e}();r.ValidatorModel=n},{}],7:[function(e,t,r){var n=e("ramda"),i=function(e){return console.log("--module "+e+"--")};r.initPrint=i;var o=function(e){return function(t){return e(t),t}};r.reflectLogger=o;var a=n.when(n.pipe(n.is(Array),n.not),n.of);r.makeArrayIfIsnt=a},{ramda:void 0}],8:[function(e,t,r){var n=e("./project"),i=function(e){var t=n.Projectlist.configSplitter(e);return t.render(),{run:function(){return t.run()},get:function(e){return t.get(e)}}};t.exports=i,Object.defineProperty(r,"__esModule",{value:!0}),r.default=i},{"./project":4}]},{},[8])(8)});